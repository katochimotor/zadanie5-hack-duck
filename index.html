<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>School 21 ‚Äî Level 2 Quest Solver</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
:root{--bg:#000;--bg2:#0a0a0a;--bg3:#111;--green:#00ff41;--green2:#00cc33;--amber:#ffb800;--amber2:#ff6600;--red:#ff0040;--emerald:#00ff88;--gray:#666;--gray2:#888;--code-bg:#0d1117;--font-pixel:'Press Start 2P',monospace;--font-mono:'JetBrains Mono',monospace;}
html{scroll-behavior:smooth;}
body{background:var(--bg);color:var(--green);font-family:var(--font-mono);font-size:14px;line-height:1.6;overflow-x:hidden;min-height:100vh;}
body::after{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,255,65,.03) 2px,rgba(0,255,65,.03) 4px);pointer-events:none;z-index:9999;}

/* Boot */
#boot-screen{position:fixed;inset:0;background:var(--bg);z-index:10000;display:flex;flex-direction:column;justify-content:center;padding:40px;font-family:var(--font-mono);color:var(--green);overflow:hidden;}
#boot-screen.hidden{display:none;}
#boot-lines{white-space:pre-wrap;font-size:13px;}
#boot-skip{position:fixed;bottom:30px;right:30px;background:transparent;border:1px solid var(--amber);color:var(--amber);font-family:var(--font-mono);padding:8px 18px;cursor:pointer;z-index:10001;font-size:12px;}
#boot-skip:hover{background:var(--amber);color:#000;}
.boot-ok{color:var(--emerald);}
.boot-warn{color:var(--amber);}
.boot-err{color:var(--red);}

/* Matrix canvas */
#matrix-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;opacity:.12;}

/* Main */
#main-app{position:relative;z-index:1;max-width:1100px;margin:0 auto;padding:20px 16px 80px;}
#main-app.hidden{display:none;}

/* Glitch heading */
.glitch{font-family:var(--font-pixel);font-size:20px;color:var(--green);text-align:center;margin:30px 0 10px;animation:glitch 3s infinite;position:relative;}
@keyframes glitch{0%,100%{text-shadow:2px 0 var(--red),-2px 0 cyan;}25%{text-shadow:-2px -1px var(--red),2px 1px cyan;}50%{text-shadow:1px 2px var(--red),-1px -2px cyan;}75%{text-shadow:-1px 0 var(--red),1px 0 cyan;}}

.subtitle{text-align:center;color:var(--gray2);font-size:12px;margin-bottom:30px;font-family:var(--font-pixel);}

/* Nav */
.quest-nav{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin:20px 0 30px;position:sticky;top:0;z-index:100;background:rgba(0,0,0,.92);padding:12px 0;border-bottom:1px solid rgba(0,255,65,.15);}
.quest-nav button{background:transparent;border:1px solid var(--green2);color:var(--green2);font-family:var(--font-mono);padding:6px 14px;cursor:pointer;font-size:11px;transition:all .2s;}
.quest-nav button:hover,.quest-nav button.active{background:var(--green);color:#000;box-shadow:0 0 12px var(--green);}

/* Sections */
.quest-section{display:none;animation:fadeIn .5s;}
.quest-section.active{display:block;}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

/* Terminal window */
.terminal{background:var(--code-bg);border:1px solid rgba(0,255,65,.3);border-radius:8px;margin:16px 0;overflow:hidden;}
.terminal-header{display:flex;align-items:center;gap:8px;padding:8px 14px;background:rgba(0,255,65,.05);border-bottom:1px solid rgba(0,255,65,.15);font-size:12px;color:var(--gray2);}
.terminal-dot{width:10px;height:10px;border-radius:50%;}
.terminal-dot.r{background:#ff5f56;}.terminal-dot.y{background:#ffbd2e;}.terminal-dot.g{background:#27c93f;}
.terminal-title{margin-left:8px;font-family:var(--font-mono);}
.terminal-actions{margin-left:auto;display:flex;gap:6px;}
.terminal-actions button{background:transparent;border:1px solid var(--gray);color:var(--gray2);font-family:var(--font-mono);font-size:10px;padding:3px 10px;cursor:pointer;transition:all .2s;border-radius:3px;}
.terminal-actions button:hover{border-color:var(--green);color:var(--green);}
.terminal-actions button.active-explain{border-color:var(--amber);color:var(--amber);box-shadow:0 0 6px var(--amber);}
.terminal-body{padding:14px;overflow-x:auto;position:relative;}
.terminal-body pre{margin:0;font-family:var(--font-mono);font-size:13px;line-height:1.7;}

/* Code lines for explain mode */
.code-line{display:block;padding:1px 4px;border-radius:2px;transition:background .15s;position:relative;}
.explain-mode .code-line:hover{background:rgba(255,184,0,.1);cursor:help;}

/* Syntax highlighting */
.kw{color:#ff7b72;} /* keywords */
.fn{color:#d2a8ff;} /* functions */
.str{color:#a5d6ff;} /* strings */
.num{color:#79c0ff;} /* numbers */
.cmt{color:#8b949e;font-style:italic;} /* comments */
.typ{color:#ff7b72;} /* types */
.pp{color:#f97583;} /* preprocessor */
.op{color:#c9d1d9;} /* operators */

/* Duck */
.duck-container{position:fixed;bottom:20px;right:20px;z-index:1000;display:flex;align-items:flex-end;gap:10px;pointer-events:none;}
.duck-bubble{background:rgba(0,0,0,.92);border:1px solid var(--amber);border-radius:10px 10px 0 10px;padding:10px 14px;max-width:320px;font-size:11px;color:var(--amber);font-family:var(--font-mono);line-height:1.5;pointer-events:auto;opacity:0;transform:translateY(10px);transition:all .3s;}
.duck-bubble.visible{opacity:1;transform:translateY(0);}
.duck-svg{width:64px;height:64px;animation:duckFloat 3s ease-in-out infinite;pointer-events:auto;cursor:pointer;filter:drop-shadow(0 0 8px rgba(255,184,0,.4));}
@keyframes duckFloat{0%,100%{transform:translateY(0);}50%{transform:translateY(-8px);}}

/* Info blocks */
.info-box{background:rgba(0,255,65,.04);border-left:3px solid var(--green);padding:12px 16px;margin:12px 0;font-size:12px;color:var(--green2);}
.info-box.amber{border-left-color:var(--amber);background:rgba(255,184,0,.04);color:var(--amber);}
.info-box.red{border-left-color:var(--red);background:rgba(255,0,64,.04);color:var(--red);}
.info-box code{background:rgba(0,255,65,.1);padding:1px 5px;border-radius:3px;font-size:12px;}

/* Cmd blocks */
.cmd-block{background:rgba(255,184,0,.05);border:1px solid rgba(255,184,0,.2);border-radius:6px;padding:10px 14px;margin:10px 0;font-size:12px;color:var(--amber);display:flex;align-items:center;gap:10px;flex-wrap:wrap;}
.cmd-block .cmd-label{color:var(--gray2);font-size:10px;font-family:var(--font-pixel);}
.cmd-block code{background:rgba(255,184,0,.1);padding:2px 8px;border-radius:3px;cursor:pointer;transition:all .15s;}
.cmd-block code:hover{background:var(--amber);color:#000;}

/* IO examples */
.io-example{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:10px 0;}
.io-box{background:rgba(0,255,65,.03);border:1px solid rgba(0,255,65,.12);border-radius:6px;padding:10px;font-size:12px;}
.io-box .io-label{font-size:10px;color:var(--gray);font-family:var(--font-pixel);margin-bottom:6px;}
.io-box pre{color:var(--green);margin:0;}

/* Section title */
.q-title{font-family:var(--font-pixel);font-size:14px;color:var(--amber);margin:24px 0 8px;text-shadow:0 0 10px rgba(255,184,0,.3);}
.q-desc{color:var(--gray2);font-size:13px;margin-bottom:14px;}

/* Story blocks */
.story{color:var(--gray2);font-size:12px;margin:10px 0;padding:10px;border:1px dashed rgba(0,255,65,.1);border-radius:4px;font-style:italic;}

/* Scrollbar */
::-webkit-scrollbar{width:6px;height:6px;}
::-webkit-scrollbar-track{background:var(--bg2);}
::-webkit-scrollbar-thumb{background:var(--green2);border-radius:3px;}

/* Responsive */
@media(max-width:600px){
.io-example{grid-template-columns:1fr;}
.glitch{font-size:14px;}
.quest-nav button{font-size:9px;padding:5px 8px;}
.duck-bubble{max-width:220px;font-size:10px;}
}

/* Toast */
.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:var(--emerald);color:#000;padding:8px 20px;border-radius:6px;font-family:var(--font-mono);font-size:12px;z-index:10000;opacity:0;transition:opacity .3s;pointer-events:none;}
.toast.show{opacity:1;}
</style>
</head>
<body>

<!-- Boot Screen -->
<div id="boot-screen">
<div id="boot-lines"></div>
<button id="boot-skip">[ESC] –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
</div>

<!-- Matrix Rain -->
<canvas id="matrix-canvas"></canvas>

<!-- Toast -->
<div class="toast" id="toast">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!</div>

<!-- Duck -->
<div class="duck-container" id="duck-container">
<div class="duck-bubble" id="duck-bubble"></div>
<svg class="duck-svg" id="duck-svg" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">
<!-- Pixel duck -->
<rect x="20" y="4" width="24" height="4" fill="#ffb800"/>
<rect x="16" y="8" width="4" height="4" fill="#ffb800"/>
<rect x="20" y="8" width="24" height="4" fill="#FFD700"/>
<rect x="44" y="8" width="4" height="4" fill="#ffb800"/>
<rect x="16" y="12" width="4" height="4" fill="#ffb800"/>
<rect x="20" y="12" width="8" height="4" fill="#FFD700"/>
<rect x="28" y="12" width="4" height="4" fill="#111"/>
<rect x="32" y="12" width="12" height="4" fill="#FFD700"/>
<rect x="44" y="12" width="4" height="4" fill="#ffb800"/>
<rect x="16" y="16" width="4" height="4" fill="#ffb800"/>
<rect x="20" y="16" width="24" height="4" fill="#FFD700"/>
<rect x="44" y="16" width="4" height="4" fill="#ffb800"/>
<rect x="12" y="20" width="4" height="4" fill="#ffb800"/>
<rect x="16" y="20" width="32" height="4" fill="#FFD700"/>
<rect x="48" y="20" width="4" height="4" fill="#ff6600"/>
<rect x="52" y="20" width="4" height="4" fill="#ff6600"/>
<rect x="8" y="24" width="4" height="4" fill="#ffb800"/>
<rect x="12" y="24" width="36" height="4" fill="#FFD700"/>
<rect x="48" y="24" width="8" height="4" fill="#ff6600"/>
<rect x="56" y="24" width="4" height="4" fill="#ff6600"/>
<rect x="8" y="28" width="4" height="4" fill="#ffb800"/>
<rect x="12" y="28" width="36" height="4" fill="#FFD700"/>
<rect x="48" y="28" width="4" height="4" fill="#ff6600"/>
<rect x="52" y="28" width="4" height="4" fill="#ff6600"/>
<rect x="12" y="32" width="4" height="4" fill="#ffb800"/>
<rect x="16" y="32" width="28" height="4" fill="#FFD700"/>
<rect x="44" y="32" width="4" height="4" fill="#ffb800"/>
<rect x="16" y="36" width="4" height="4" fill="#ffb800"/>
<rect x="20" y="36" width="20" height="4" fill="#FFD700"/>
<rect x="40" y="36" width="4" height="4" fill="#ffb800"/>
<rect x="12" y="40" width="8" height="4" fill="#ff6600"/>
<rect x="20" y="40" width="20" height="4" fill="#ffb800"/>
<rect x="40" y="40" width="8" height="4" fill="#ff6600"/>
<rect x="8" y="44" width="8" height="4" fill="#ff6600"/>
<rect x="44" y="44" width="8" height="4" fill="#ff6600"/>
</svg>
</div>

<!-- Main App -->
<div id="main-app" class="hidden">
<h1 class="glitch">SCHOOL 21 ‚Äî LEVEL 2</h1>
<p class="subtitle">POINTER QUEST SOLVER</p>

<div class="quest-nav" id="quest-nav"></div>

<!-- Quests will be injected here -->
<div id="quests-container"></div>
</div>

<script>
// ==================== BOOT SEQUENCE ====================
(function(){
const bootLines = [
{text:'BIOS v3.14 ‚Äî POST check...', delay:100},
{text:'[  OK  ] Memory check: 640K', cls:'boot-ok', delay:150},
{text:'[  OK  ] Loading kernel modules...', cls:'boot-ok', delay:200},
{text:'[  OK  ] Initializing file system...', cls:'boot-ok', delay:180},
{text:'[WARN ] Corrupted sectors detected in /dev/labyrinth', cls:'boot-warn', delay:300},
{text:'', delay:100},
{text:'  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó', delay:30},
{text:'  ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïë', delay:30},
{text:'  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ïë', delay:30},
{text:'  ‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë', delay:30},
{text:'  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë', delay:30},
{text:'  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù', delay:30},
{text:'', delay:100},
{text:'[  OK  ] Loading AI Data Analyzer v0.01...', cls:'boot-ok', delay:250},
{text:'[  OK  ] Loading pointer modules...', cls:'boot-ok', delay:200},
{text:'[  OK  ] Loading quest database...', cls:'boot-ok', delay:200},
{text:'[  OK  ] Initializing duck assistant...', cls:'boot-ok', delay:300},
{text:'[ ERR  ] Segmentation fault in room_1.module', cls:'boot-err', delay:400},
{text:'[WARN ] Repair required. Launching interactive solver...', cls:'boot-warn', delay:500},
{text:'', delay:200},
{text:'> READY. Press any key or wait...', delay:0},
];
const container = document.getElementById('boot-lines');
const screen = document.getElementById('boot-screen');
const skipBtn = document.getElementById('boot-skip');
let idx = 0;
let done = false;
function finishBoot(){
if(done) return;
done = true;
screen.classList.add('hidden');
document.getElementById('main-app').classList.remove('hidden');
}
function nextLine(){
if(done) return;
if(idx >= bootLines.length){setTimeout(finishBoot, 1200); return;}
const l = bootLines[idx++];
const span = document.createElement('div');
span.textContent = l.text;
if(l.cls) span.className = l.cls;
container.appendChild(span);
container.scrollTop = container.scrollHeight;
setTimeout(nextLine, l.delay + 60);
}
nextLine();
skipBtn.addEventListener('click', finishBoot);
document.addEventListener('keydown', function handler(e){
if(e.key === 'Escape' || !done){
finishBoot();
document.removeEventListener('keydown', handler);
}
});
setTimeout(finishBoot, 15000);
})();

// ==================== MATRIX RAIN ====================
(function(){
const canvas = document.getElementById('matrix-canvas');
const ctx = canvas.getContext('2d');
function resize(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;}
resize(); window.addEventListener('resize', resize);
const chars = '„Ç¢„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É©„ÉØABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789*+=-<>{}[]';
const fontSize = 14;
let columns = Math.floor(canvas.width / fontSize);
let drops = new Array(columns).fill(1);
function draw(){
ctx.fillStyle = 'rgba(0,0,0,0.05)';
ctx.fillRect(0,0,canvas.width,canvas.height);
ctx.fillStyle = '#00ff41';
ctx.font = fontSize + 'px monospace';
for(let i=0;i<drops.length;i++){
const text = chars[Math.floor(Math.random()*chars.length)];
ctx.fillText(text, i*fontSize, drops[i]*fontSize);
if(drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i]=0;
drops[i]++;
}
}
setInterval(draw, 50);
window.addEventListener('resize',()=>{columns=Math.floor(canvas.width/fontSize);drops=new Array(columns).fill(1);});
})();

// ==================== DUCK HELPER ====================
const duckBubble = document.getElementById('duck-bubble');
const duckSvg = document.getElementById('duck-svg');
let duckTimeout = null;
const duckIdlePhrases = [
'–ö—Ä—è! –ù–∞–∂–º–∏ "–û–±—ä—è—Å–Ω–∏—Ç—å –∫–æ–¥" –∏ –Ω–∞–≤–µ–¥–∏ –Ω–∞ —Å—Ç—Ä–æ–∫—É ‚Äî —è –ø–æ–º–æ–≥—É!',
'–ù–µ –∑–∞–±—É–¥—å: –Ω–∏–∫–∞–∫–∏—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ goto!',
'–ö—Ä—è-–∫—Ä—è! –£–∫–∞–∑–∞—Ç–µ–ª–∏ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∞–¥—Ä–µ—Å–∞ –≤ –ø–∞–º—è—Ç–∏!',
'–ü–æ–º–Ω–∏: –æ–¥–∏–Ω –≤—ã—Ö–æ–¥ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏!',
'stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω –≤ –∫–≤–µ—Å—Ç–∞—Ö 5-8!',
'–ú–∞—Å—Å–∏–≤ ‚Äî —ç—Ç–æ —É–∫–∞–∑–∞—Ç–µ–ª—å! –í—Å—ë —É–∫–∞–∑–∞—Ç–µ–ª—å! –ö—Ä—è!',
'–ú–∞–∫—Å–∏–º—É–º 42 —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é. –î–µ–∫–æ–º–ø–æ–∑–∏—Ä—É–π!',
];
function duckSay(text, duration){
clearTimeout(duckTimeout);
duckBubble.textContent = text;
duckBubble.classList.add('visible');
if(duration){
duckTimeout = setTimeout(()=>{duckBubble.classList.remove('visible');}, duration);
}
}
function duckHide(){
duckBubble.classList.remove('visible');
}
duckSvg.addEventListener('click', ()=>{
duckSay(duckIdlePhrases[Math.floor(Math.random()*duckIdlePhrases.length)], 5000);
});

// ==================== TOAST ====================
function showToast(msg){
const t = document.getElementById('toast');
t.textContent = msg || '–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
t.classList.add('show');
setTimeout(()=>t.classList.remove('show'), 1500);
}

// ==================== COPY ====================
function copyCode(id){
const el = document.getElementById(id);
if(!el) return;
const text = el.textContent;
navigator.clipboard.writeText(text).then(()=>showToast()).catch(()=>{
const ta=document.createElement('textarea');ta.value=text;document.body.appendChild(ta);ta.select();document.execCommand('copy');document.body.removeChild(ta);showToast();
});
}

// ==================== EXPLAIN MODE ====================
function toggleExplain(btnId, bodyId){
const btn = document.getElementById(btnId);
const body = document.getElementById(bodyId);
if(!btn || !body) return;
const isActive = btn.classList.toggle('active-explain');
if(isActive){
body.classList.add('explain-mode');
duckSay('–†–µ–∂–∏–º –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≤–∫–ª—é—á—ë–Ω! –ù–∞–≤–µ–¥–∏ –º—ã—à—å –Ω–∞ —Å—Ç—Ä–æ–∫—É –∫–æ–¥–∞.', 4000);
} else {
body.classList.remove('explain-mode');
duckHide();
}
}

// Line hover handler for explain mode
document.addEventListener('mouseover', function(e){
const line = e.target.closest('.code-line');
if(!line) return;
const body = line.closest('.terminal-body');
if(!body || !body.classList.contains('explain-mode')) return;
const explanation = line.getAttribute('data-explain');
if(explanation){
duckSay(explanation);
}
});
document.addEventListener('mouseout', function(e){
const line = e.target.closest('.code-line');
if(!line) return;
const body = line.closest('.terminal-body');
if(body && body.classList.contains('explain-mode')){
// keep visible briefly
}
});

// ==================== HIGHLIGHT HELPER ====================
function hl(code){
// Simple syntax highlighter
return code
.replace(/\/\/(.*)/g, '<span class="cmt">//$1</span>')
.replace(/\/\*([\s\S]*?)\*\//g, '<span class="cmt">/*$1*/</span>')
.replace(/"([^"]*)"/g, '<span class="str">"$1"</span>')
.replace(/\b(int|void|char|float|double|long|short|unsigned|signed|const|static|return|if|else|for|while|do|break|switch|case|default|sizeof|typedef|struct|enum|union)\b/g, '<span class="kw">$1</span>')
.replace(/\b(scanf|printf|main)\b/g, '<span class="fn">$1</span>')
.replace(/#(include|define|ifndef|endif|ifdef)\b/g, '<span class="pp">#$1</span>')
.replace(/\b(\d+\.?\d*)\b/g, '<span class="num">$1</span>');
}

function makeCodeLines(code, explanations){
const lines = code.split('\n');
let html = '';
for(let i = 0; i < lines.length; i++){
const exp = (explanations && explanations[i]) ? ' data-explain="' + explanations[i].replace(/"/g,'&quot;') + '"' : '';
html += '<span class="code-line"' + exp + '>' + hl(escHtml(lines[i])) + '</span>\n';
}
return html;
}

function escHtml(s){
return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

// ==================== QUESTS DATA ====================
const quests = [
// ============ QUEST 1 ============
{
id: 'q1',
title: 'Quest 1. Arguments and pointers ‚Äî maxmin.c',
story: '–ú–æ–¥—É–ª—å maxmin –≤—ã–∑—ã–≤–∞–µ—Ç Segmentation fault. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—á–∏–Ω–∏—Ç—å –µ–≥–æ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –Ω–∞—Ö–æ–¥–∏–ª max –∏ min –∏–∑ 3 —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª.',
code: `#include <stdio.h>

void max_min(int a, int b, int c, int *max, int *min) {
  *max = a;
  *min = a;
  if (b > *max) *max = b;
  if (c > *max) *max = c;
  if (b < *min) *min = b;
  if (c < *min) *min = c;
}

int main(void) {
  int a, b, c;
  int max, min;
  if (scanf("%d %d %d", &a, &b, &c) != 3) {
    printf("n/a");
  } else {
    max_min(a, b, c, &max, &min);
    printf("%d %d", max, min);
  }
  return 0;
}`,
explanations: {
0: '#include <stdio.h> ‚Äî –ø–æ–¥–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞ (printf, scanf)',
2: '–§—É–Ω–∫—Ü–∏—è max_min –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 —á–∏—Å–ª–∞ –∏ 2 —É–∫–∞–∑–∞—Ç–µ–ª—è –¥–ª—è –∑–∞–ø–∏—Å–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (max –∏ min)',
3: '*max = a ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø–æ –∞–¥—Ä–µ—Å—É max –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ a',
4: '*min = a ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –º–∏–Ω–∏–º—É–º–∞',
5: '–ï—Å–ª–∏ b –±–æ–ª—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ max, –æ–±–Ω–æ–≤–ª—è–µ–º max',
6: '–ï—Å–ª–∏ c –±–æ–ª—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ max, –æ–±–Ω–æ–≤–ª—è–µ–º max',
7: '–ï—Å–ª–∏ b –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ min, –æ–±–Ω–æ–≤–ª—è–µ–º min',
8: '–ï—Å–ª–∏ c –º–µ–Ω—å—à–µ —Ç–µ–∫—É—â–µ–≥–æ min, –æ–±–Ω–æ–≤–ª—è–µ–º min',
11: '–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞. –ù–∏–∫–∞–∫–∏—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö!',
12: '–û–±—ä—è–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö',
13: '–û–±—ä—è–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Äî max –∏ min',
14: 'scanf –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ —Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π; –æ–∂–∏–¥–∞–µ–º 3',
15: '–ü—Ä–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º –≤–≤–æ–¥–µ –≤—ã–≤–æ–¥–∏–º "n/a"',
17: '–ü–µ—Ä–µ–¥–∞—ë–º –∞–¥—Ä–µ—Å–∞ max –∏ min ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—à–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—è–º',
18: '–í—ã–≤–æ–¥–∏–º max –∏ min —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª',
20: 'return 0 ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã—Ö–æ–¥ –∏–∑ main (—É—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)',
},
filename: 'maxmin.c',
inputs: ['1 2 3'],
outputs: ['3 1'],
commands: [
'gcc -Wall -Werror -Wextra src/maxmin.c -o maxmin',
'echo "1 2 3" | ./maxmin',
'clang-format -n src/maxmin.c',
'cppcheck --enable=all --suppress=missingIncludeSystem src/maxmin.c',
],
},
// ============ QUEST 2 ============
{
id: 'q2',
title: 'Quest 2. Data I/O ‚Äî squaring.c',
story: '–ú–æ–¥—É–ª—å squaring –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª, –≤–æ–∑–≤–æ–¥–∏—Ç –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç. –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞.',
code: `#include <stdio.h>

#define MAX_SIZE 100

int input_array(int *arr, int *n) {
  int result = 0;
  if (scanf("%d", n) == 1 && *n > 0 && *n <= MAX_SIZE) {
    for (int i = 0; i < *n && result == 0; i++) {
      if (scanf("%d", &arr[i]) != 1) {
        result = 1;
      }
    }
  } else {
    result = 1;
  }
  return result;
}

void square_array(int *arr, int n) {
  for (int i = 0; i < n; i++) {
    arr[i] = arr[i] * arr[i];
  }
}

void output_array(const int *arr, int n) {
  for (int i = 0; i < n; i++) {
    if (i > 0) printf(" ");
    printf("%d", arr[i]);
  }
}

int main(void) {
  int arr[MAX_SIZE];
  int n;
  if (input_array(arr, &n) != 0) {
    printf("n/a");
  } else {
    square_array(arr, n);
    output_array(arr, n);
  }
  return 0;
}`,
explanations: {
0: '#include <stdio.h> ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞',
2: '#define MAX_SIZE 100 ‚Äî –º–∞–∫—Ä–æ—Å –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –º–∞—Å—Å–∏–≤–∞',
4: '–§—É–Ω–∫—Ü–∏—è –≤–≤–æ–¥–∞ –º–∞—Å—Å–∏–≤–∞. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –º–∞—Å—Å–∏–≤ –∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ä–∞–∑–º–µ—Ä',
5: 'result = 0 –æ–∑–Ω–∞—á–∞–µ—Ç "–Ω–µ—Ç –æ—à–∏–±–∫–∏"',
6: '–°—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä n. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ scanf –≤–µ—Ä–Ω—É–ª 1 –∏ n –≤ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø—Ä–µ–¥–µ–ª–∞—Ö',
7: '–¶–∏–∫–ª —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Ç–æ—á–∫–æ–π –≤—ã—Ö–æ–¥–∞ ‚Äî —É—Å–ª–æ–≤–∏–µ —Ü–∏–∫–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ i < n, –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫',
8: '–ß–∏—Ç–∞–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç. –ï—Å–ª–∏ scanf –Ω–µ —Å—á–∏—Ç–∞–ª ‚Äî –æ—à–∏–±–∫–∞',
9: 'result = 1 ‚Äî —Å–∏–≥–Ω–∞–ª –æ–± –æ—à–∏–±–∫–µ',
18: '–§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ –∫–≤–∞–¥—Ä–∞—Ç. –ú–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é',
19: '–ü—Ä–æ—Å—Ç–æ–π —Ü–∏–∫–ª –ø–æ –≤—Å–µ–º —ç–ª–µ–º–µ–Ω—Ç–∞–º',
20: 'arr[i] = arr[i] * arr[i] ‚Äî –≤–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç –Ω–∞ –º–µ—Å—Ç–µ',
23: '–§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞. const ‚Äî –æ–±–µ—â–∞–µ–º –Ω–µ –º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ',
24: '–¶–∏–∫–ª –≤—ã–≤–æ–¥–∞',
25: '–ü–µ—á–∞—Ç–∞–µ–º –ø—Ä–æ–±–µ–ª-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–µ—Ä–µ–¥ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ',
26: '–í—ã–≤–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç',
30: 'main ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞',
31: '–ú–∞—Å—Å–∏–≤ –Ω–∞ —Å—Ç–µ–∫–µ. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–∞–º—è—Ç—å –∑–∞–ø—Ä–µ—â–µ–Ω–∞!',
33: '–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–≤–æ–¥. –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî "n/a"',
36: '–°–Ω–∞—á–∞–ª–∞ –≤–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç, –ø–æ—Ç–æ–º –≤—ã–≤–æ–¥–∏–º',
39: '–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π return –∏–∑ main',
},
filename: 'squaring.c',
inputs: ['3', '1 2 3'],
outputs: ['1 4 9'],
commands: [
'gcc -Wall -Werror -Wextra src/squaring.c -o squaring',
'echo "3\\n1 2 3" | ./squaring',
],
},
// ============ QUEST 3 ============
{
id: 'q3',
title: 'Quest 3. Data metrics ‚Äî stat.c',
story: '–ú–æ–¥—É–ª—å stat –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏: max, min, —Å—Ä–µ–¥–Ω–µ–µ (–º–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ) –∏ –¥–∏—Å–ø–µ—Ä—Å–∏—é –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.',
code: `#include <stdio.h>

#define MAX_SIZE 100

int input_array(int *arr, int *n) {
  int result = 0;
  if (scanf("%d", n) == 1 && *n > 0 && *n <= MAX_SIZE) {
    for (int i = 0; i < *n && result == 0; i++) {
      if (scanf("%d", &arr[i]) != 1) {
        result = 1;
      }
    }
  } else {
    result = 1;
  }
  return result;
}

void output_array(const int *arr, int n) {
  for (int i = 0; i < n; i++) {
    if (i > 0) printf(" ");
    printf("%d", arr[i]);
  }
}

int find_max(const int *arr, int n) {
  int max_val = arr[0];
  for (int i = 1; i < n; i++) {
    if (arr[i] > max_val) max_val = arr[i];
  }
  return max_val;
}

int find_min(const int *arr, int n) {
  int min_val = arr[0];
  for (int i = 1; i < n; i++) {
    if (arr[i] < min_val) min_val = arr[i];
  }
  return min_val;
}

double calc_mean(const int *arr, int n) {
  double sum = 0.0;
  for (int i = 0; i < n; i++) {
    sum += arr[i];
  }
  return sum / n;
}

double calc_variance(const int *arr, int n, double mean) {
  double sum = 0.0;
  for (int i = 0; i < n; i++) {
    double diff = arr[i] - mean;
    sum += diff * diff;
  }
  return sum / n;
}

int main(void) {
  int arr[MAX_SIZE];
  int n;
  if (input_array(arr, &n) != 0) {
    printf("n/a");
  } else {
    output_array(arr, n);
    printf("\\n");
    int max_val = find_max(arr, n);
    int min_val = find_min(arr, n);
    double mean = calc_mean(arr, n);
    double variance = calc_variance(arr, n, mean);
    printf("%d %d %lf %lf", max_val, min_val, mean, variance);
  }
  return 0;
}`,
explanations: {
0: '–ü–æ–¥–∫–ª—é—á–∞–µ–º stdio.h –¥–ª—è –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞',
2: '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ ‚Äî 100',
4: '–§—É–Ω–∫—Ü–∏—è –≤–≤–æ–¥–∞: —Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏ —ç–ª–µ–º–µ–Ω—Ç—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0 –ø—Ä–∏ —É—Å–ø–µ—Ö–µ',
18: '–§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ –º–∞—Å—Å–∏–≤–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª—ã',
25: 'find_max ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç –º–∞–∫—Å–∏–º—É–º, –Ω–∞—á–∏–Ω–∞—è —Å arr[0]',
26: '–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º max –ø–µ—Ä–≤—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º',
27: '–ü—Ä–æ—Ö–æ–¥–∏–º —Å 1-–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ ‚Äî 0-–π —É–∂–µ —É—á—Ç—ë–Ω',
28: '–ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –±–æ–ª—å—à–µ max ‚Äî –æ–±–Ω–æ–≤–ª—è–µ–º',
33: 'find_min ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –º–∏–Ω–∏–º—É–º–∞',
40: 'calc_mean ‚Äî –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ = —Å—É–º–º–∞/n –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è',
41: 'sum —Ç–∏–ø–∞ double –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏',
47: 'calc_variance ‚Äî –¥–∏—Å–ø–µ—Ä—Å–∏—è = Œ£(xi - mean)¬≤ / n –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è',
49: 'diff = –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ',
50: '–°—É–º–º–∏—Ä—É–µ–º –∫–≤–∞–¥—Ä–∞—Ç—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π',
52: '–î–µ–ª–∏–º –Ω–∞ n (–Ω–µ n-1, —Ç.–∫. –ø–æ —É—Å–ª–æ–≤–∏—é ‚Äî –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ)',
55: 'main ‚Äî —Å–æ–±–∏—Ä–∞–µ–º –≤—Å—ë –≤–º–µ—Å—Ç–µ',
61: '–í—ã–≤–æ–¥–∏–º –º–∞—Å—Å–∏–≤, –∑–∞—Ç–µ–º –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ',
65: 'printf —Å %lf –∏ —Ç–æ—á–Ω–æ—Å—Ç—å—é 6 –∑–Ω–∞–∫–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)',
},
filename: 'stat.c',
inputs: ['4', '1 2 3 4'],
outputs: ['1 2 3 4\n4 1 2.500000 1.250000'],
commands: [
'gcc -Wall -Werror -Wextra src/stat.c -o stat -lm',
'echo "4\\n1 2 3 4" | ./stat',
],
},
// ============ QUEST 4 ============
{
id: 'q4',
title: 'Quest 4. Search ‚Äî search.c',
story: '–ù–∞–π—Ç–∏ –ø–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ: —á—ë—Ç–Ω–æ–µ, >= —Å—Ä–µ–¥–Ω–µ–≥–æ, –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 3 —Å–∏–≥–º, –Ω–µ —Ä–∞–≤–Ω–æ–µ 0. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤—ã–≤–µ—Å—Ç–∏ 0. –ú–∞–∫—Å–∏–º—É–º 30 —ç–ª–µ–º–µ–Ω—Ç–æ–≤.',
code: `#include <stdio.h>
#include <math.h>

#define MAX_SIZE 30

int input_array(int *arr, int *n) {
  int result = 0;
  if (scanf("%d", n) == 1 && *n > 0 && *n <= MAX_SIZE) {
    for (int i = 0; i < *n && result == 0; i++) {
      if (scanf("%d", &arr[i]) != 1) {
        result = 1;
      }
    }
  } else {
    result = 1;
  }
  return result;
}

double calc_mean(const int *arr, int n) {
  double sum = 0.0;
  for (int i = 0; i < n; i++) {
    sum += arr[i];
  }
  return sum / n;
}

double calc_variance(const int *arr, int n, double mean) {
  double sum = 0.0;
  for (int i = 0; i < n; i++) {
    double diff = arr[i] - mean;
    sum += diff * diff;
  }
  return sum / n;
}

int is_even(int x) {
  return x % 2 == 0;
}

int check_three_sigma(int x, double mean, double sigma) {
  return fabs(x - mean) <= 3.0 * sigma;
}

int search(const int *arr, int n) {
  double mean = calc_mean(arr, n);
  double variance = calc_variance(arr, n, mean);
  double sigma = sqrt(variance);
  int found = 0;
  int result = 0;
  for (int i = 0; i < n && found == 0; i++) {
    if (arr[i] != 0 && is_even(arr[i]) &&
        (double)arr[i] >= mean &&
        check_three_sigma(arr[i], mean, sigma)) {
      result = arr[i];
      found = 1;
    }
  }
  return result;
}

int main(void) {
  int arr[MAX_SIZE];
  int n;
  if (input_array(arr, &n) != 0) {
    printf("n/a");
  } else {
    int result = search(arr, n);
    printf("%d", result);
  }
  return 0;
}`,
explanations: {
0: 'stdio.h –¥–ª—è –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞',
1: 'math.h –¥–ª—è sqrt –∏ fabs',
3: '–ú–∞–∫—Å–∏–º—É–º 30 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ —É—Å–ª–æ–≤–∏—é',
5: '–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≤–≤–æ–¥–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∫–≤–µ—Å—Ç–æ–≤',
19: 'calc_mean ‚Äî –º–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º',
27: 'calc_variance ‚Äî –¥–∏—Å–ø–µ—Ä—Å–∏—è, –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º',
35: '–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —á—ë—Ç–Ω–æ—Å—Ç—å',
38: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª–∞ 3 —Å–∏–≥–º: |x - mean| <= 3œÉ',
42: '–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ ‚Äî –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è!',
43: '–°—á–∏—Ç–∞–µ–º mean',
44: '–°—á–∏—Ç–∞–µ–º –¥–∏—Å–ø–µ—Ä—Å–∏—é',
45: 'sigma = ‚àö(variance) ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ',
46: '–§–ª–∞–≥ found ‚Äî –¥–ª—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ü–∏–∫–ª–∞',
47: 'result = 0 ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ)',
48: '–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ü–∏–∫–ª–∞: i < n && found == 0',
49: '–ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —É—Å–ª–æ–≤–∏—è: –Ω–µ 0, —á—ë—Ç–Ω–æ–µ, >= mean, –ø—Ä–∞–≤–∏–ª–æ 3œÉ',
},
filename: 'search.c',
inputs: ['4', '1 2 3 4'],
outputs: ['4'],
commands: [
'gcc -Wall -Werror -Wextra src/search.c -o search -lm',
'echo "4\\n1 2 3 4" | ./search',
],
},
// ============ QUEST 5 ============
{
id: 'q5',
title: 'Quest 5. Sort & memory ‚Äî sort.c',
story: '–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤ –∏–∑ 10 —á–∏—Å–µ–ª –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é. stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω! –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è: —á—Ç–µ–Ω–∏–µ, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –≤—ã–≤–æ–¥.',
code: `#include <stdio.h>

#define SIZE 10

int input_array(int *arr, int n) {
  int result = 0;
  for (int i = 0; i < n && result == 0; i++) {
    if (scanf("%d", &arr[i]) != 1) {
      result = 1;
    }
  }
  return result;
}

void swap(int *a, int *b) {
  int temp = *a;
  *a = *b;
  *b = temp;
}

void sort_array(int *arr, int n) {
  for (int i = 0; i < n - 1; i++) {
    for (int j = 0; j < n - 1 - i; j++) {
      if (arr[j] > arr[j + 1]) {
        swap(&arr[j], &arr[j + 1]);
      }
    }
  }
}

void output_array(const int *arr, int n) {
  for (int i = 0; i < n; i++) {
    if (i > 0) printf(" ");
    printf("%d", arr[i]);
  }
}

int main(void) {
  int arr[SIZE];
  if (input_array(arr, SIZE) != 0) {
    printf("n/a");
  } else {
    sort_array(arr, SIZE);
    output_array(arr, SIZE);
  }
  return 0;
}`,
explanations: {
0: '–¢–æ–ª—å–∫–æ stdio.h! stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω –ø–æ —É—Å–ª–æ–≤–∏—é',
2: '#define SIZE 10 ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞',
4: '–§—É–Ω–∫—Ü–∏—è –≤–≤–æ–¥–∞. –†–æ–≤–Ω–æ 10 —á–∏—Å–µ–ª. –ú–∞—Å—Å–∏–≤ –ø–æ —É–∫–∞–∑–∞—Ç–µ–ª—é',
6: '–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Ç–æ—á–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ü–∏–∫–ª–∞',
7: '–ï—Å–ª–∏ scanf –Ω–µ —Å—á–∏—Ç–∞–ª —á–∏—Å–ª–æ ‚Äî –æ—à–∏–±–∫–∞',
14: 'swap ‚Äî –æ–±–º–µ–Ω –¥–≤—É—Ö –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª–∏. –ö–ª–∞—Å—Å–∏–∫–∞!',
15: 'temp —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç *a',
16: '*a = *b ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–µ–º b –ø–æ –∞–¥—Ä–µ—Å—É a',
17: '*b = temp ‚Äî –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –∞–¥—Ä–µ—Å—É b',
20: '–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø—É–∑—ã—Ä—å–∫–æ–º (Bubble Sort). –ú–æ–∂–Ω–æ –ª—é–±–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º',
21: '–í–Ω–µ—à–Ω–∏–π —Ü–∏–∫–ª ‚Äî –ø—Ä–æ—Ö–æ–¥—ã',
22: '–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ü–∏–∫–ª ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –æ–±–º–µ–Ω—ã',
23: '–ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π > —Å–ª–µ–¥—É—é—â–µ–≥–æ ‚Äî –º–µ–Ω—è–µ–º –º–µ—Å—Ç–∞–º–∏',
24: 'swap —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞—Ç–µ–ª–∏ ‚Äî –ø–µ—Ä–µ–¥–∞—ë–º –∞–¥—Ä–µ—Å–∞',
29: '–§—É–Ω–∫—Ü–∏—è –≤—ã–≤–æ–¥–∞ ‚Äî —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª—ã',
35: 'main: –≤–≤–æ–¥ ‚Üí —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ ‚Üí –≤—ã–≤–æ–¥',
36: '–ú–∞—Å—Å–∏–≤ –Ω–∞ —Å—Ç–µ–∫–µ, –±–µ–∑ malloc!',
37: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞',
40: '–°–æ—Ä—Ç–∏—Ä—É–µ–º –∏ –≤—ã–≤–æ–¥–∏–º',
},
filename: 'sort.c',
inputs: ['4 3 9 0 1 2 100 2 7 -1'],
outputs: ['-1 0 1 2 2 3 4 7 9 100'],
commands: [
'gcc -Wall -Werror -Wextra src/sort.c -o sort',
'echo "4 3 9 0 1 2 100 2 7 -1" | ./sort',
],
},
// ============ QUEST 6 ============
{
id: 'q6',
title: 'Quest 6. Several arrays ‚Äî key9part1.c',
story: '–ü—Ä–∏–Ω—è—Ç—å —Ä–∞–∑–º–µ—Ä –∏ –º–∞—Å—Å–∏–≤. –í—ã–≤–µ—Å—Ç–∏ —Å—É–º–º—É —á—ë—Ç–Ω—ã—Ö (0 ‚Äî –Ω–µ—á—ë—Ç–Ω–æ–µ). –í—ã–≤–µ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ —Å—É–º–º–∞ –¥–µ–ª–∏—Ç—Å—è –Ω–∞—Ü–µ–ª–æ. –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä 10.',
code: `#include <stdio.h>

#define MAX_SIZE 10

int input_array(int *arr, int *n) {
  int result = 0;
  if (scanf("%d", n) == 1 && *n > 0 && *n <= MAX_SIZE) {
    for (int i = 0; i < *n && result == 0; i++) {
      if (scanf("%d", &arr[i]) != 1) {
        result = 1;
      }
    }
  } else {
    result = 1;
  }
  return result;
}

int calc_even_sum(const int *arr, int n) {
  int sum = 0;
  for (int i = 0; i < n; i++) {
    if (arr[i] != 0 && arr[i] % 2 == 0) {
      sum += arr[i];
    }
  }
  return sum;
}

int build_divisible(const int *src, int n, int *dst, int sum) {
  int count = 0;
  for (int i = 0; i < n; i++) {
    if (src[i] != 0 && sum % src[i] == 0) {
      dst[count] = src[i];
      count++;
    }
  }
  return count;
}

void output_array(const int *arr, int n) {
  for (int i = 0; i < n; i++) {
    if (i > 0) printf(" ");
    printf("%d", arr[i]);
  }
}

int main(void) {
  int arr[MAX_SIZE];
  int result[MAX_SIZE];
  int n;
  if (input_array(arr, &n) != 0) {
    printf("n/a");
  } else {
    int sum = calc_even_sum(arr, n);
    if (sum == 0) {
      printf("n/a");
    } else {
      int count = build_divisible(arr, n, result, sum);
      if (count == 0) {
        printf("n/a");
      } else {
        printf("%d\\n", sum);
        output_array(result, count);
      }
    }
  }
  return 0;
}`,
explanations: {
0: '–¢–æ–ª—å–∫–æ stdio.h!',
2: '–ú–∞–∫—Å–∏–º—É–º 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
4: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–≤–æ–¥–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏',
18: '–°—É–º–º–∞ —á—ë—Ç–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –í–ê–ñ–ù–û: 0 —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ—á—ë—Ç–Ω—ã–º –ø–æ —É—Å–ª–æ–≤–∏—é!',
20: '–ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –º–∞—Å—Å–∏–≤—É',
21: 'arr[i] != 0 ‚Äî –Ω–æ–ª—å –Ω–µ—á—ë—Ç–Ω—ã–π –ø–æ —É—Å–ª–æ–≤–∏—é; arr[i] % 2 == 0 ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—ë—Ç–Ω–æ—Å—Ç–∏',
28: '–°—Ç—Ä–æ–∏–º –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤ –∏–∑ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ sum –¥–µ–ª–∏—Ç—Å—è –Ω–∞—Ü–µ–ª–æ',
30: '–ü—Ä–æ—Ö–æ–¥–∏–º –∏—Å—Ö–æ–¥–Ω—ã–π –º–∞—Å—Å–∏–≤',
31: 'src[i] != 0 ‚Äî –¥–µ–ª–∏—Ç—å –Ω–∞ 0 –Ω–µ–ª—å–∑—è; sum % src[i] == 0 ‚Äî –¥–µ–ª–∏—Ç—Å—è –Ω–∞—Ü–µ–ª–æ',
32: '–î–æ–±–∞–≤–ª—è–µ–º –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –º–∞—Å—Å–∏–≤',
39: '–í—ã–≤–æ–¥ –º–∞—Å—Å–∏–≤–∞ ‚Äî –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º',
45: 'main: –≤—Ö–æ–¥–Ω–æ–π –∏ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –º–∞—Å—Å–∏–≤—ã –Ω–∞ —Å—Ç–µ–∫–µ',
50: '–°—á–∏—Ç–∞–µ–º —Å—É–º–º—É —á—ë—Ç–Ω—ã—Ö',
51: '–ï—Å–ª–∏ –Ω–µ—Ç —á—ë—Ç–Ω—ã—Ö (sum == 0) ‚Äî "n/a"',
53: '–°—Ç—Ä–æ–∏–º –º–∞—Å—Å–∏–≤ –¥–µ–ª–∏—Ç–µ–ª–µ–π',
54: '–ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –Ω–µ—Ç ‚Äî "n/a"',
56: '–í—ã–≤–æ–¥–∏–º —Å—É–º–º—É –∏ –Ω–æ–≤—ã–π –º–∞—Å—Å–∏–≤',
},
filename: 'key9part1.c',
inputs: ['10', '4 3 9 0 1 2 0 2 7 -1'],
outputs: ['8\n4 1 2 2 -1'],
commands: [
'gcc -Wall -Werror -Wextra src/key9part1.c -o key9part1',
'echo "10\\n4 3 9 0 1 2 0 2 7 -1" | ./key9part1',
],
},
// ============ QUEST 7 ============
{
id: 'q7',
title: 'Quest 7. Cyclic shift ‚Äî cycle_shift.c',
story: '–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –º–∞—Å—Å–∏–≤–∞ –≤–ª–µ–≤–æ –Ω–∞ c –ø–æ–∑–∏—Ü–∏–π. –ü—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º c ‚Äî –≤–ø—Ä–∞–≤–æ. –ú–∞–∫—Å. 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤, stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω.',
code: `#include <stdio.h>

#define MAX_SIZE 10

int input_array(int *arr, int *n) {
  int result = 0;
  if (scanf("%d", n) == 1 && *n > 0 && *n <= MAX_SIZE) {
    for (int i = 0; i < *n && result == 0; i++) {
      if (scanf("%d", &arr[i]) != 1) {
        result = 1;
      }
    }
  } else {
    result = 1;
  }
  return result;
}

void reverse(int *arr, int left, int right) {
  for (int l = left, r = right; l < r; l++, r--) {
    int temp = arr[l];
    arr[l] = arr[r];
    arr[r] = temp;
  }
}

void cycle_shift(int *arr, int n, int c) {
  int shift = c % n;
  if (shift < 0) {
    shift += n;
  }
  if (shift != 0) {
    reverse(arr, 0, shift - 1);
    reverse(arr, shift, n - 1);
    reverse(arr, 0, n - 1);
  }
}

void output_array(const int *arr, int n) {
  for (int i = 0; i < n; i++) {
    if (i > 0) printf(" ");
    printf("%d", arr[i]);
  }
}

int main(void) {
  int arr[MAX_SIZE];
  int n;
  int c;
  if (input_array(arr, &n) != 0) {
    printf("n/a");
  } else {
    if (scanf("%d", &c) != 1) {
      printf("n/a");
    } else {
      cycle_shift(arr, n, c);
      output_array(arr, n);
    }
  }
  return 0;
}`,
explanations: {
0: '–¢–æ–ª—å–∫–æ stdio.h ‚Äî stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω!',
2: '–ú–∞–∫—Å–∏–º—É–º 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤',
4: '–§—É–Ω–∫—Ü–∏—è –≤–≤–æ–¥–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π (–ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º)',
18: 'reverse ‚Äî —Ä–∞–∑–≤–æ—Ä–æ—Ç –ø–æ–¥–º–∞—Å—Å–∏–≤–∞ arr[left..right]. –ö–ª—é—á –∫ –∞–ª–≥–æ—Ä–∏—Ç–º—É!',
19: '–î–≤–∞ —É–∫–∞–∑–∞—Ç–µ–ª—è –¥–≤–∏–≥–∞—é—Ç—Å—è –Ω–∞–≤—Å—Ç—Ä–µ—á—É: l –æ—Ç left, r –æ—Ç right',
20: 'temp –¥–ª—è –æ–±–º–µ–Ω–∞',
25: 'cycle_shift ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º —á–µ—Ä–µ–∑ 3 —Ä–µ–≤–µ—Ä—Å–∞',
26: 'shift = c % n ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å–¥–≤–∏–≥ (—É–±–∏—Ä–∞–µ–º –ø–æ–ª–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã)',
27: '–ï—Å–ª–∏ shift –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π (—Å–¥–≤–∏–≥ –≤–ø—Ä–∞–≤–æ) ‚Äî –ø—Ä–∏–≤–æ–¥–∏–º –∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º—É —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—É',
30: '–ê–ª–≥–æ—Ä–∏—Ç–º —Ç—Ä—ë—Ö —Ä–µ–≤–µ—Ä—Å–æ–≤: reverse(0..shift-1), reverse(shift..n-1), reverse(0..n-1)',
31: '–†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ª–µ–≤—É—é —á–∞—Å—Ç—å [0, shift-1]',
32: '–†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø—Ä–∞–≤—É—é —á–∞—Å—Ç—å [shift, n-1]',
33: '–†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –≤–µ—Å—å –º–∞—Å—Å–∏–≤ ‚Äî –≥–æ—Ç–æ–≤–æ!',
36: '–í—ã–≤–æ–¥ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª—ã',
42: 'main: –≤–≤–æ–¥–∏–º –º–∞—Å—Å–∏–≤, –∑–∞—Ç–µ–º –≤–µ–ª–∏—á–∏–Ω—É —Å–¥–≤–∏–≥–∞',
48: '–°—á–∏—Ç—ã–≤–∞–µ–º c –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –º–∞—Å—Å–∏–≤–∞',
},
filename: 'cycle_shift.c',
inputs: ['10', '4 3 9 0 1 2 0 2 7 -1', '2'],
outputs: ['9 0 1 2 0 2 7 -1 4 3'],
commands: [
'gcc -Wall -Werror -Wextra src/cycle_shift.c -o cycle_shift',
'echo "10\\n4 3 9 0 1 2 0 2 7 -1\\n2" | ./cycle_shift',
],
},
// ============ QUEST 8 (BONUS) ============
{
id: 'q8',
title: '‚òÖ Quest 8. Arbitrary-precision arithmetic ‚Äî key9part2.c',
story: '–°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–∞–∫ –º–∞—Å—Å–∏–≤—ã —Ü–∏—Ñ—Ä. –ú–∞–∫—Å. 100 —Ü–∏—Ñ—Ä. stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω.',
code: `#include <stdio.h>

#define MAX_LEN 100

int input_number(int *arr, int *len) {
  int result = 0;
  int buf[MAX_LEN];
  int n = 0;
  int ch;
  int started = 0;
  while ((ch = getchar()) != '\\n' && ch != EOF && n < MAX_LEN) {
    if (ch == ' ') {
      if (n > 0) started = 1;
    } else if (ch >= '0' && ch <= '9') {
      if (started || n > 0 || ch != '0') {
        buf[n] = ch - '0';
        n++;
        started = 1;
      }
    } else {
      result = 1;
    }
  }
  if (n == 0 && result == 0) {
    buf[0] = 0;
    n = 1;
  }
  *len = n;
  for (int i = 0; i < n; i++) {
    arr[i] = buf[i];
  }
  return result;
}

void add_numbers(const int *a, int la, const int *b, int lb,
                 int *res, int *lr) {
  int carry = 0;
  int ia = la - 1;
  int ib = lb - 1;
  int ir = MAX_LEN - 1;
  int tmp[MAX_LEN] = {0};
  for (; ia >= 0 || ib >= 0 || carry; ir--) {
    int sum = carry;
    if (ia >= 0) {
      sum += a[ia];
      ia--;
    }
    if (ib >= 0) {
      sum += b[ib];
      ib--;
    }
    tmp[ir + 1] = sum % 10;
    carry = sum / 10;
  }
  int start = ir + 2;
  int len = MAX_LEN - start;
  if (len == 0) {
    res[0] = 0;
    *lr = 1;
  } else {
    for (int i = 0; i < len; i++) {
      res[i] = tmp[start + i];
    }
    *lr = len;
  }
}

int compare(const int *a, int la, const int *b, int lb) {
  int result = 0;
  if (la != lb) {
    result = (la > lb) ? 1 : -1;
  } else {
    int i = 0;
    while (i < la && a[i] == b[i]) {
      i++;
    }
    if (i < la) {
      result = (a[i] > b[i]) ? 1 : -1;
    }
  }
  return result;
}

int sub_numbers(const int *a, int la, const int *b, int lb,
                int *res, int *lr) {
  int err = 0;
  if (compare(a, la, b, lb) < 0) {
    err = 1;
  } else {
    int borrow = 0;
    int ia = la - 1;
    int ib = lb - 1;
    int tmp[MAX_LEN] = {0};
    int ir = MAX_LEN - 1;
    for (; ia >= 0; ia--, ir--) {
      int digit_a = a[ia];
      int digit_b = (ib >= 0) ? b[ib] : 0;
      int diff = digit_a - digit_b - borrow;
      if (diff < 0) {
        diff += 10;
        borrow = 1;
      } else {
        borrow = 0;
      }
      tmp[ir + 1] = diff;
      if (ib >= 0) ib--;
    }
    int start = 0;
    for (int i = 0; i < MAX_LEN; i++) {
      if (tmp[i] != 0) {
        start = i;
        break;
      }
      start = MAX_LEN - 1;
    }
    int len = MAX_LEN - start;
    for (int i = 0; i < len; i++) {
      res[i] = tmp[start + i];
    }
    *lr = len;
  }
  return err;
}

void output_number(const int *arr, int n) {
  for (int i = 0; i < n; i++) {
    if (i > 0) printf(" ");
    printf("%d", arr[i]);
  }
}

int main(void) {
  int a[MAX_LEN], b[MAX_LEN];
  int la, lb;
  int sum_r[MAX_LEN + 1], diff_r[MAX_LEN];
  int ls, ld;
  if (input_number(a, &la) != 0 || input_number(b, &lb) != 0) {
    printf("n/a");
  } else {
    add_numbers(a, la, b, lb, sum_r, &ls);
    output_number(sum_r, ls);
    printf("\\n");
    if (sub_numbers(a, la, b, lb, diff_r, &ld) != 0) {
      printf("n/a");
    } else {
      output_number(diff_r, ld);
    }
  }
  return 0;
}`,
explanations: {
0: '–¢–æ–ª—å–∫–æ stdio.h!',
2: '–ú–∞–∫—Å–∏–º—É–º 100 —Ü–∏—Ñ—Ä ‚Äî –¥–ª–∏–Ω–Ω–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞',
4: '–í–≤–æ–¥ —á–∏—Å–ª–∞ –∫–∞–∫ –º–∞—Å—Å–∏–≤–∞ —Ü–∏—Ñ—Ä, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø—Ä–æ–±–µ–ª–∞–º–∏',
10: '–ß–∏—Ç–∞–µ–º –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ –¥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ç—Ä–æ–∫–∏',
14: '–ü—Ä–æ–ø—É—Å–∫–∞–µ–º –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏ (–∫—Ä–æ–º–µ —á–∏—Å–ª–∞ "0")',
34: 'add_numbers ‚Äî —Å–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–æ–ª–±–∏–∫–æ–º, –∫–∞–∫ –≤ —à–∫–æ–ª–µ!',
35: '–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ res, –¥–ª–∏–Ω—É ‚Äî –≤ lr',
36: 'carry ‚Äî –ø–µ—Ä–µ–Ω–æ—Å —Ä–∞–∑—Ä—è–¥–∞',
37: '–ù–∞—á–∏–Ω–∞–µ–º —Å –º–ª–∞–¥—à–∏—Ö —Ä–∞–∑—Ä—è–¥–æ–≤ (—Å –∫–æ–Ω—Ü–∞ –º–∞—Å—Å–∏–≤–∞)',
42: '–°–∫–ª–∞–¥—ã–≤–∞–µ–º –ø–æ—Ä–∞–∑—Ä—è–¥–Ω–æ + –ø–µ—Ä–µ–Ω–æ—Å',
51: '–ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Ü–∏—Ñ—Ä—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –≤—ã—á–∏—Å–ª—è–µ–º –Ω–æ–≤—ã–π –ø–µ—Ä–µ–Ω–æ—Å',
62: 'compare ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –¥–ª–∏–Ω–Ω—ã—Ö —á–∏—Å–µ–ª',
64: '–°–Ω–∞—á–∞–ª–∞ –ø–æ –¥–ª–∏–Ω–µ ‚Äî –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω–æ–µ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ',
67: '–ü—Ä–∏ —Ä–∞–≤–Ω—ã—Ö –¥–ª–∏–Ω–∞—Ö ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ø–æ—Ä–∞–∑—Ä—è–¥–Ω–æ —Å–ª–µ–≤–∞',
76: 'sub_numbers ‚Äî –≤—ã—á–∏—Ç–∞–Ω–∏–µ —Å—Ç–æ–ª–±–∏–∫–æ–º',
78: '–ï—Å–ª–∏ —É–º–µ–Ω—å—à–∞–µ–º–æ–µ –º–µ–Ω—å—à–µ –≤—ã—á–∏—Ç–∞–µ–º–æ–≥–æ ‚Äî –æ—à–∏–±–∫–∞ (–ø–æ —É—Å–ª–æ–≤–∏—é)',
83: 'borrow ‚Äî –∑–∞—ë–º —Ä–∞–∑—Ä—è–¥–∞ –ø—Ä–∏ –≤—ã—á–∏—Ç–∞–Ω–∏–∏',
88: '–í—ã—á–∏—Ç–∞–µ–º –ø–æ—Ä–∞–∑—Ä—è–¥–Ω–æ —Å —É—á—ë—Ç–æ–º –∑–∞—ë–º–∞',
89: '–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π ‚Äî –∑–∞–Ω–∏–º–∞–µ–º –∏–∑ —Å—Ç–∞—Ä—à–µ–≥–æ —Ä–∞–∑—Ä—è–¥–∞',
101: '–£–±–∏—Ä–∞–µ–º –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞',
112: '–í—ã–≤–æ–¥ —á–∏—Å–ª–∞ –∫–∞–∫ –º–∞—Å—Å–∏–≤–∞ —Ü–∏—Ñ—Ä —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª—ã',
118: 'main: —á–∏—Ç–∞–µ–º –¥–≤–∞ —á–∏—Å–ª–∞, –≤—ã–≤–æ–¥–∏–º —Å—É–º–º—É –∏ —Ä–∞–∑–Ω–æ—Å—Ç—å',
},
filename: 'key9part2.c',
inputs: ['1 9 4 4 6 7 4 4 0 7 3 7 0 9 5 5 1 6 1', '2 9'],
outputs: ['1 9 4 4 6 7 4 4 0 7 3 7 0 9 5 5 1 9 0\n1 9 4 4 6 7 4 4 0 7 3 7 0 9 5 5 1 3 2'],
commands: [
'gcc -Wall -Werror -Wextra src/key9part2.c -o key9part2',
'printf "1 9 4 4 6 7 4 4 0 7 3 7 0 9 5 5 1 6 1\\n2 9\\n" | ./key9part2',
],
},
];

// ==================== RENDER ====================
const navEl = document.getElementById('quest-nav');
const container = document.getElementById('quests-container');

quests.forEach((q, idx) => {
// Nav button
const btn = document.createElement('button');
btn.textContent = q.title.split('.')[0] + '.' + (q.title.includes('‚òÖ') ? ' ‚òÖ' : '');
btn.setAttribute('data-idx', idx);
btn.addEventListener('click', () => activateQuest(idx));
navEl.appendChild(btn);

// Section
const section = document.createElement('div');
section.className = 'quest-section';
section.id = 'section-' + q.id;

const codeId = 'code-' + q.id;
const bodyId = 'body-' + q.id;
const copyBtnId = 'copy-' + q.id;
const explBtnId = 'expl-' + q.id;

// Build code lines with explanations
const codeLines = q.code.split('\n');
let codeHtml = '';
for(let i = 0; i < codeLines.length; i++){
const exp = (q.explanations && q.explanations[i]) ? ' data-explain="' + q.explanations[i].replace(/"/g,'&quot;').replace(/'/g,'&#39;') + '"' : '';
codeHtml += '<span class="code-line"' + exp + '>' + hl(escHtml(codeLines[i])) + '</span>\n';
}

let ioHtml = '';
if(q.inputs.length && q.outputs.length){
ioHtml = '<div class="io-example">';
ioHtml += '<div class="io-box"><div class="io-label">STDIN:</div><pre>' + escHtml(q.inputs.join('\n')) + '</pre></div>';
ioHtml += '<div class="io-box"><div class="io-label">STDOUT:</div><pre>' + escHtml(q.outputs.join('\n').replace(/\\n/g,'\n')) + '</pre></div>';
ioHtml += '</div>';
}

let cmdHtml = '';
q.commands.forEach(cmd => {
cmdHtml += `<div class="cmd-block"><span class="cmd-label">$</span><code onclick="navigator.clipboard.writeText(this.textContent.trim());showToast();">${escHtml(cmd)}</code></div>`;
});

section.innerHTML = `
<h2 class="q-title">${escHtml(q.title)}</h2>
<div class="story">${escHtml(q.story)}</div>

<div class="terminal">
  <div class="terminal-header">
    <span class="terminal-dot r"></span>
    <span class="terminal-dot y"></span>
    <span class="terminal-dot g"></span>
    <span class="terminal-title">‚îå‚îÄ ${escHtml(q.filename)} ‚îÄ‚îê</span>
    <div class="terminal-actions">
      <button id="${copyBtnId}" onclick="copyCode('${codeId}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      <button id="${explBtnId}" onclick="toggleExplain('${explBtnId}','${bodyId}')">ü¶Ü –û–±—ä—è—Å–Ω–∏—Ç—å –∫–æ–¥</button>
    </div>
  </div>
  <div class="terminal-body" id="${bodyId}">
    <pre id="${codeId}">${codeHtml}</pre>
  </div>
</div>

<div class="info-box amber">
  <strong>üí° –í–∞–∂–Ω–æ:</strong> –ù–∏–∫–∞–∫–∏—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, goto, exit(). –û–¥–∏–Ω return –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏. –û–¥–∏–Ω –≤—ã—Ö–æ–¥ –∏–∑ —Ü–∏–∫–ª–∞. –ú–∞–∫—Å. 42 —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é. –í–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å ‚â§ 4.
  ${q.id === 'q5' || q.id === 'q6' || q.id === 'q7' || q.id === 'q8' ? '<br><strong>‚õî stdlib.h –∑–∞–ø—Ä–µ—â—ë–Ω!</strong>' : ''}
</div>

<h3 style="color:var(--amber);font-family:var(--font-pixel);font-size:11px;margin-top:16px;">üì• –í–≤–æ–¥ / –í—ã–≤–æ–¥:</h3>
${ioHtml}

<h3 style="color:var(--amber);font-family:var(--font-pixel);font-size:11px;margin-top:16px;">‚å®Ô∏è –ö–æ–º–∞–Ω–¥—ã (–∫–ª–∏–∫–Ω–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è):</h3>
${cmdHtml}

<div class="info-box">
  <strong>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏:</strong><br>
  ‚Ä¢ –°—Ç–∏–ª—å: <code>clang-format -n src/${escHtml(q.filename)}</code><br>
  ‚Ä¢ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: <code>cppcheck --enable=all --suppress=missingIncludeSystem src/${escHtml(q.filename)}</code><br>
  ‚Ä¢ Push –≤ –≤–µ—Ç–∫—É <code>develop</code>, —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ <code>src/</code>
</div>
`;
container.appendChild(section);
});

function activateQuest(idx){
document.querySelectorAll('.quest-section').forEach(s => s.classList.remove('active'));
document.querySelectorAll('.quest-nav button').forEach(b => b.classList.remove('active'));
const section = document.getElementById('section-' + quests[idx].id);
if(section) section.classList.add('active');
navEl.children[idx].classList.add('active');
duckSay('–ö–≤–µ—Å—Ç ' + (idx+1) + ': ' + quests[idx].story.substring(0, 80) + '...', 5000);
}

// Activate first quest by default
setTimeout(() => activateQuest(0), 100);

</script>
</body>
</html>